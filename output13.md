---
domain: langfuse.com
path: /docs/integrations/langchain/tracing
url: https://langfuse.com/docs/integrations/langchain/tracing
---

[Join us in Engineering & DevRel →We're hiring. Join us in Product Eng, Backend Eng, and DevRel →](/careers)

[![Langfuse Logo](https://langfuse.com/langfuse_logo_white.svg)![Langfuse Logo](https://langfuse.com/langfuse_logo.svg)](/)
[DocsDocs](/docs)
[PricingPricing](/pricing)
[ChangelogChangelog](/changelog)
[BlogBlog](/blog)

Demo

[Discord](https://discord.langfuse.com)
[](https://x.com/langfuse)
[GitHub](https://github.com/langfuse/langfuse "GitHub Repository")
[Sign Up](https://cloud.langfuse.com)

*   Docs
    
    [Guides](/guides)
    [FAQ](/faq)
    
*   [Overview](/docs)
    
*   [Interactive Demo](/docs/demo)
    
*   Self-host
    
    *   [Local (docker compose)](/docs/deployment/local)
        
    *   [Self-host (docker)](/docs/deployment/self-host)
        
    
*   Tracing
*   [Introduction](/docs/tracing)
    
*   [Quickstart](/docs/get-started)
    
*   Features
    
    *   [Sessions](/docs/tracing-features/sessions)
        
    *   [Users](/docs/tracing-features/users)
        
    *   [Metadata](/docs/tracing-features/metadata)
        
    *   [Tags](/docs/tracing-features/tags)
        
    *   [Trace URL](/docs/tracing-features/url)
        
    *   [Log Levels](/docs/tracing-features/log-levels)
        
    *   [Sampling](/docs/tracing-features/sampling)
        
    
*   SDKs
    
    *   [Overview](/docs/sdk/overview)
        
    *   Python
        
        *   [Decorators](/docs/sdk/python/decorators)
            
        *   [Example Notebook](/docs/sdk/python/example)
            
        *   [Low-level SDK](/docs/sdk/python/low-level-sdk)
            
        *   [Reference ↗ (opens in a new tab)](https://python.reference.langfuse.com)
            
        
    *   JS/TS
        
        *   [Guide](/docs/sdk/typescript/guide)
            
        *   [Guide (Web)](/docs/sdk/typescript/guide-web)
            
        *   [Example (Vercel AI)](/docs/sdk/typescript/example-vercel-ai)
            
        *   [Reference ↗ (opens in a new tab)](https://js.reference.langfuse.com)
            
        
    
*   Integrations
    
    *   [Overview](/docs/integrations/overview)
        
    *   OpenAI SDK
        
        *   Python
            
            *   [Get Started](/docs/integrations/openai/python/get-started)
                
            *   [Track Errors](/docs/integrations/openai/python/track-errors)
                
            *   [Example Notebook](/docs/integrations/openai/python/examples)
                
            *   [Assistants API](/docs/integrations/openai/python/assistants-api)
                
            *   [Structured Outputs](/docs/integrations/openai/python/structured-outputs)
                
            
        *   JS/TS
            
            *   [Get Started](/docs/integrations/openai/js/get-started)
                
            *   [Example Notebook](/docs/integrations/openai/js/examples)
                
            
        
    *   Langchain
        
        *   [Tracing](/docs/integrations/langchain/tracing)
            
        *   [Example Python](/docs/integrations/langchain/example-python)
            
        *   [Example JS](/docs/integrations/langchain/example-javascript)
            
        *   [Example LangGraph](/docs/integrations/langchain/example-python-langgraph)
            
        *   [Example LangServe](/docs/integrations/langchain/example-python-langserve)
            
        *   [Upgrade Paths](/docs/integrations/langchain/upgrade-paths)
            
        
    *   LlamaIndex
        
        *   [Get Started](/docs/integrations/llama-index/get-started)
            
        *   [Example (Python)](/docs/integrations/llama-index/example-python)
            
        
    *   Haystack
        
        *   [Get Started](/docs/integrations/haystack/get-started)
            
        *   [Example (Python)](/docs/integrations/haystack/example-python)
            
        
    *   LiteLLM
        
        *   [Tracing](/docs/integrations/litellm/tracing)
            
        *   [Example Proxy (Python)](/docs/integrations/litellm/example-proxy-python)
            
        *   [Example Proxy (JS/TS)](/docs/integrations/litellm/example-proxy-js)
            
        
    *   [Vercel AI SDK](/docs/integrations/vercel-ai-sdk)
        
    *   [Dify.AI](/docs/integrations/dify)
        
    *   [Instructor](/docs/integrations/instructor)
        
    *   Mirascope
        
        *   [Tracing](/docs/integrations/mirascope/tracing)
            
        *   [Example Notebook](/docs/integrations/mirascope/example-python)
            
        
    *   [Flowise](/docs/integrations/flowise)
        
    *   [Langflow](/docs/integrations/langflow)
        
    
*   [Query Traces](/docs/query-traces)
    
*   Develop
*   Prompt Management
    
    *   [Get Started](/docs/prompts/get-started)
        
    *   [Example OpenAI Functions](/docs/prompts/example-openai-functions)
        
    *   [Example Langchain (Py)](/docs/prompts/example-langchain)
        
    *   [Example Langchain (JS)](/docs/prompts/example-langchain-js)
        
    
*   [Playground](/docs/playground)
    
*   [Fine-tuning](/docs/fine-tuning)
    
*   Monitor
*   Analytics
    
    *   [Overview](/docs/analytics/overview)
        
    *   [PostHog Integration](/docs/analytics/posthog)
        
    *   [Daily Metrics API](/docs/analytics/daily-metrics-api)
        
    
*   [Model Usage & Cost](/docs/model-usage-and-cost)
    
*   Scores & Evaluation
    
    *   [Overview](/docs/scores/overview)
        
    *   [Annotation in UI](/docs/scores/annotation)
        
    *   [User Feedback](/docs/scores/user-feedback)
        
    *   [Model-based Evaluation](/docs/scores/model-based-evals)
        
    *   [Custom via SDKs/API](/docs/scores/custom)
        
    
*   LLM Security
    
    *   [Overview](/docs/security/overview)
        
    *   [Example Python](/docs/security/example-python)
        
    
*   Test
*   [Experimentation](/docs/experimentation)
    
*   Datasets
    
    *   [Overview](/docs/datasets/overview)
        
    *   [Cookbook](/docs/datasets/python-cookbook)
        
    
*   References
*   [API ↗ (opens in a new tab)](https://api.reference.langfuse.com)
    
*   [Python SDK ↗ (opens in a new tab)](https://python.reference.langfuse.com)
    
*   [JS SDK ↗ (opens in a new tab)](https://js.reference.langfuse.com)
    
*   More
*   [Access Control (RBAC)](/docs/rbac)
    
*   [Data Security & Privacy](/docs/data-security-privacy)
    
*   [Open Source](/docs/open-source)
    
*   [Roadmap](/docs/roadmap)
    
*   [Support ↗ (opens in a new tab)](/support)
    

Light

On This Page

*   [Add Langfuse to your Langchain application](#add-langfuse-to-your-langchain-application)
    
*   [Supported LangChain interfaces](#supported-langchain-interfaces)
    
*   [Supported LangChain features](#supported-langchain-features)
    
*   [Additional Configuration](#additional-configuration)
    
*   [Optional constructor arguments](#optional-constructor-arguments)
    
*   [Interoperability with Langfuse SDKs](#interoperability)
    
*   [Queuing and flushing](#queuing-and-flushing)
    
*   [FAQ](#faq)
    

[Question? Give us feedback → (opens in a new tab)](https://github.com/langfuse/langfuse-docs/issues/new?title=Feedback%20for%20%E2%80%9COSS%20Observability%20for%20LangChain%E2%80%9D&labels=feedback)
[Edit this page on GitHub](https://github.com/langfuse/langfuse-docs/tree/main/pages/docs/integrations/langchain/tracing.mdx)
Scroll to top

Docs

Integrations

Langchain

Tracing

Tracing for Langchain (Python & JS/TS)
======================================

[Langfuse Tracing](/docs/tracing)
 integrates with Langchain using Langchain Callbacks ([Python (opens in a new tab)](https://python.langchain.com/docs/modules/callbacks/)
, [JS (opens in a new tab)](https://js.langchain.com/docs/modules/callbacks/)
). Thereby, the Langfuse SDK automatically creates a nested trace for every run of your Langchain applications. This allows you to log, analyze and debug your LangChain application.

Add Langfuse to your Langchain application[](#add-langfuse-to-your-langchain-application)

------------------------------------------------------------------------------------------

You can configure the integration via (1) constructor arguments or (2) environment variables. Get your Langfuse credentials from the Langfuse dashboard.

Python (constructor args)Python (env)JS (constructor args)JS (env)

    pip install langfuse

    # Initialize Langfuse handler
    from langfuse.callback import CallbackHandler
    langfuse_handler = CallbackHandler(
        secret_key="sk-lf-...",
        public_key="pk-lf-...",
        host="https://cloud.langfuse.com", # 🇪🇺 EU region
      # host="https://us.cloud.langfuse.com", # 🇺🇸 US region
    )
     
    # Your Langchain code
     
    # Add Langfuse handler as callback (classic and LCEL)
    chain.invoke({"input": "<user_input>"}, config={"callbacks": [langfuse_handler]})

Also works for `run` and `predict` methods.

    chain.run(input="<user_input>", callbacks=[langfuse_handler]) # Legacy
    conversation.predict(input="<user_input>", callbacks=[langfuse_handler])

✨

Done. Now you can explore detailed traces and metrics in the Langfuse dashboard.

Prefer end-to-end examples?

[Example (Python)](/docs/integrations/langchain/example-python)
[Example (JS/TS)](/docs/integrations/langchain/example-javascript)
[Example LangGraph (Python)](/docs/integrations/langchain/example-python-langgraph)
[Example LangServe (Python)](/docs/integrations/langchain/example-python-langserve)

Supported LangChain interfaces[](#supported-langchain-interfaces)

------------------------------------------------------------------

| Feature/interface | Python | JS/TS |
| --- | --- | --- |
| LCEL | ✅   | ✅   |
| `invoke()` | ✅   | ✅   |
| `run()` | ✅   | ✅   |
| `call()` | ✅   | ✅   |
| `predict()` | ✅   | ✅   |
| async | ✅   | ✅   |
| `batch()` | ✅   | (✅) |
| streaming | ✅   | ✅   |

We are interested in your feedback! Raise an issue on [GitHub](/ideas)
 to request support for additional interfaces.

Supported LangChain features[](#supported-langchain-features)

--------------------------------------------------------------

*   **🕸️ LangGraph**: Works with Langfuse Integration. Requires Python 3.11+ ([GH issue (opens in a new tab)](https://github.com/langfuse/langfuse/issues/1926)
    ). See notebook for [example integration](/docs/integrations/langchain/example-python-langgraph)
    .
*   **🏓 LangServe**: See notebook for [example integration](/docs/integrations/langchain/example-python-langserve)
    .

Additional Configuration[](#additional-configuration)

------------------------------------------------------

### Optional constructor arguments[](#optional-constructor-arguments)

When initializing the Langfuse handler, you can pass the following **optional** arguments to use more advanced features.

| Python | JS/TS | Type | Description |
| --- | --- | --- | --- |
| `user_id` | `userId` | string | The current [user](/docs/tracing-features/users)<br>. |
| `session_id` | `sessionId` | string | The current [session](/docs/tracing-features/sessions)<br>. |
| `release` | `release` | string | The release of your application. See [experimentation docs](/docs/experimentation)<br> for details. |
| `version` | `version` | string | The version of your application. See [experimentation docs](/docs/experimentation)<br> for details. |
| `trace_name` |     | string | Customize the name of the created traces. Defaults to name of chain. |
| `enabled` | `enabled` | boolean | Enable or disable the Langfuse integration. Defaults to `true`. |
| `sample_rate` | `-` | float | [Sample rate](/docs/tracing-features/sampling)<br> for tracing. |

### Interoperability with Langfuse SDKs[](#interoperability)

Use the Langchain integration in combination with the regular Langfuse SDKs if you want to:

*   Add non-Langchain related observations to the trace.
*   Group multiple Langchain runs into a single trace.

Learn more about the structure of a trace [here](/docs/tracing)
.

Python DecoratorJSPython low-level SDK

    from langfuse.decorators import langfuse_context, observe
     
    # Create a trace via Langfuse decorators and get a Langchain Callback handler for it
    @observe() # automtically log function as a trace to Langfuse
    def main():
        # update trace attributes (e.g, name, session_id, user_id)
        langfuse_context.update_current_trace(
            name="custom-trace",
            session_id="user-1234",
            user_id="session-1234",
        )
        # get the langchain handler for the current trace
        langfuse_handler = langfuse_context.get_current_langchain_handler()
     
        # Your Langchain code
     
        # Add Langfuse handler as callback (classic and LCEL)
        chain.invoke({"input": "<user_input>"}, config={"callbacks": [langfuse_handler]})
     
    main()

Limitation (decorator + langchain): The input/output of the Langchain code will not be added to the trace or span created by the decorator but to a child. Adding them would cause unwanted side-effects if they are set manually or if you add multiple Langchain runs.

If you pass these callback handlers to your Langchain code, the events will be nested under the respective trace or span in the Langfuse.

See the [Langchain observability cookbook](/docs/integrations/langchain/example-python)
 for an example of this in action (Python).

### Queuing and flushing[](#queuing-and-flushing)

The Langfuse SDKs queue and batch events in the background to reduce the number of network requests and improve overall performance. In a long-running application, this works without any additional configuration.

If you are running a short-lived application, you need to shutdown Langfuse to ensure that all events are flushed before the application exits.

PythonJS

    langfuse_handler.shutdown()

If you want to flush events synchronously at a certain point, you can use the `flush` method. This will wait for all events that are still in the background queue to be sent to the Langfuse API. This is usually discouraged in production environments.

PythonJS

    langfuse_handler.flush()

FAQ[](#faq)

------------

*   [How to customize the names of observations within a Langchain trace?](/faq/all/custom-langchain-run-names)
    

[Example Notebook](/docs/integrations/openai/js/examples "Example Notebook")
[Example Python](/docs/integrations/langchain/example-python "Example Python")

### Was this page useful?

YesCould be better

### Questions? We're here to help

[GitHub Q&AGitHub](/gh-support)
Chat [Email](/cdn-cgi/l/email-protection#02717772726d7076426e636c65647771672c616d6f)
[Talk to sales](/schedule-demo)

### Subscribe to updates

Get updates

Light

* * *

Platform

*   [LLM Tracing](/docs/tracing)
    
*   [Prompt Management](/docs/prompts/get-started)
    
*   [Evaluation](/docs/scores/overview)
    
*   [Manual Annotation](/docs/scores/annotation)
    
*   [Datasets](/docs/datasets/overview)
    
*   [Metrics](/docs/analytics)
    
*   [Playground](/docs/playground)
    

Integrations

*   [Python SDK](/docs/sdk/python)
    
*   [JS/TS SDK](/docs/sdk/typescript/guide)
    
*   [OpenAI SDK](/docs/integrations/openai/get-started)
    
*   [Langchain](/docs/integrations/langchain/tracing)
    
*   [Llama-Index](/docs/integrations/llama-index/get-started)
    
*   [Litellm](/docs/integrations/litellm)
    
*   [Dify](/docs/integrations/dify)
    
*   [Flowise](/docs/integrations/flowise)
    
*   [Langflow](/docs/integrations/langflow)
    
*   [Vercel AI SDK](/docs/sdk/typescript/example-vercel-ai)
    
*   [Instructor](/docs/integrations/instructor)
    
*   [Mirascope](/docs/integrations/mirascope)
    
*   [API](https://api.reference.langfuse.com/)
    

Resources

*   [Documentation](/docs)
    
*   [Interactive Demo](/demo)
    
*   [Video demo (3 min)](/video)
    
*   [Changelog](/changelog)
    
*   [Roadmap](/docs/roadmap)
    
*   [Pricing](/pricing)
    
*   [Enterprise](/enterprise)
    
*   [Self-hosting](/docs/deployment/self-host)
    
*   [Open Source](/docs/open-source)
    
*   [Why Langfuse?](/why)
    
*   [Status](https://status.langfuse.com)
    

About

*   [Blog](/blog)
    
*   [Careers](/careers)
    3
*   [About us](/about)
    
*   [Support](/support)
    
*   [Schedule Demo](/schedule-demo)
    
*   [OSS Friends](/oss-friends)
    

Legal

*   [Security](/security)
    
*   [Imprint](/imprint)
    
*   [Terms](/terms)
    
*   [Privacy](/privacy)
    

© 2022-2024 Langfuse GmbH / Finto Technologies Inc.